---
source: litebox_syscall_rewriter/tests/snapshot_tests.rs
expression: diff
---
--- original
+++ rewritten
@@ -1279,9 +1279,10 @@
  8049df3:	74 11                	je     8049e06 <__libc_start_call_main+0x96>
  8049df5:	ba 01 00 00 00       	mov    $0x1,%edx
  8049dfa:	31 db                	xor    %ebx,%ebx
- 8049dfc:	8d 74 26 00          	lea    0x0(%esi,%eiz,1),%esi
- 8049e00:	89 d0                	mov    %edx,%eax
- 8049e02:	cd 80                	int    $0x80
+ 8049dfc:	e9 0b d2 09 00       	jmp    80e700c <_end+0x3c4>
+ 8049e01:	90                   	nop
+ 8049e02:	90                   	nop
+ 8049e03:	90                   	nop
  8049e04:	eb fa                	jmp    8049e00 <__libc_start_call_main+0x90>
  8049e06:	31 c0                	xor    %eax,%eax
  8049e08:	eb d0                	jmp    8049dda <__libc_start_call_main+0x6a>
@@ -3543,20 +3544,25 @@
  804bf83:	ff
  804bf84:	c7 44 24 48 ff ff 0f 	movl   $0xfffff,0x48(%esp)
  804bf8b:	00
- 804bf8c:	c7 44 24 4c 51 00 00 	movl   $0x51,0x4c(%esp)
- 804bf93:	00
- 804bf94:	cd 80                	int    $0x80
+ 804bf8c:	e9 93 b0 09 00       	jmp    80e7024 <_end+0x3dc>
+ 804bf91:	90                   	nop
+ 804bf92:	90                   	nop
+ 804bf93:	90                   	nop
+ 804bf94:	90                   	nop
+ 804bf95:	90                   	nop
  804bf96:	83 c4 10             	add    $0x10,%esp
  804bf99:	85 c0                	test   %eax,%eax
  804bf9b:	0f 84 bf 00 00 00    	je     804c060 <__libc_setup_tls+0x2a0>
  804bfa1:	b8 04 00 00 00       	mov    $0x4,%eax
  804bfa6:	bb 02 00 00 00       	mov    $0x2,%ebx
  804bfab:	8d 8e 20 e6 fc ff    	lea    -0x319e0(%esi),%ecx
- 804bfb1:	ba 2d 00 00 00       	mov    $0x2d,%edx
- 804bfb6:	cd 80                	int    $0x80
+ 804bfb1:	e9 88 b0 09 00       	jmp    80e703e <_end+0x3f6>
+ 804bfb6:	90                   	nop
+ 804bfb7:	90                   	nop
  804bfb8:	b8 fc 00 00 00       	mov    $0xfc,%eax
- 804bfbd:	bb 7f 00 00 00       	mov    $0x7f,%ebx
- 804bfc2:	cd 80                	int    $0x80
+ 804bfbd:	e9 93 b0 09 00       	jmp    80e7055 <_end+0x40d>
+ 804bfc2:	90                   	nop
+ 804bfc3:	90                   	nop
  804bfc4:	e8 67 ff 00 00       	call   805bf30 <__tls_init_tp>
  804bfc9:	8b 44 24 1c          	mov    0x1c(%esp),%eax
  804bfcd:	c7 85 60 02 00 00 01 	movl   $0x1,0x260(%ebp)
@@ -3600,11 +3606,13 @@
  804c078:	b8 04 00 00 00       	mov    $0x4,%eax
  804c07d:	bb 02 00 00 00       	mov    $0x2,%ebx
  804c082:	8d 8e 20 e6 fc ff    	lea    -0x319e0(%esi),%ecx
- 804c088:	ba 2d 00 00 00       	mov    $0x2d,%edx
- 804c08d:	cd 80                	int    $0x80
+ 804c088:	e9 df af 09 00       	jmp    80e706c <_end+0x424>
+ 804c08d:	90                   	nop
+ 804c08e:	90                   	nop
  804c08f:	b8 fc 00 00 00       	mov    $0xfc,%eax
- 804c094:	bb 7f 00 00 00       	mov    $0x7f,%ebx
- 804c099:	cd 80                	int    $0x80
+ 804c094:	e9 ea af 09 00       	jmp    80e7083 <_end+0x43b>
+ 804c099:	90                   	nop
+ 804c09a:	90                   	nop
  804c09b:	e9 46 fe ff ff       	jmp    804bee6 <__libc_setup_tls+0x126>
 
 0804c0a0 <__libc_assert_fail>:
@@ -20527,8 +20535,8 @@
  805a305:	81 c2 ef 8c 08 00    	add    $0x88cef,%edx
  805a30b:	53                   	push   %ebx
  805a30c:	b8 2d 00 00 00       	mov    $0x2d,%eax
- 805a311:	8b 5c 24 08          	mov    0x8(%esp),%ebx
- 805a315:	cd 80                	int    $0x80
+ 805a311:	e9 84 cd 08 00       	jmp    80e709a <_end+0x452>
+ 805a316:	90                   	nop
  805a317:	89 82 28 36 00 00    	mov    %eax,0x3628(%edx)
  805a31d:	39 d8                	cmp    %ebx,%eax
  805a31f:	72 07                	jb     805a328 <__brk+0x28>
@@ -23765,13 +23773,12 @@
  805c9ae:	5d                   	pop    %ebp
  805c9af:	c3                   	ret
  805c9b0:	b9 2d 00 00 00       	mov    $0x2d,%ecx
- 805c9b5:	31 db                	xor    %ebx,%ebx
- 805c9b7:	89 c8                	mov    %ecx,%eax
- 805c9b9:	cd 80                	int    $0x80
+ 805c9b5:	e9 f6 a6 08 00       	jmp    80e70b0 <_end+0x468>
+ 805c9ba:	90                   	nop
  805c9bb:	89 c2                	mov    %eax,%edx
- 805c9bd:	8d 1c 28             	lea    (%eax,%ebp,1),%ebx
- 805c9c0:	89 c8                	mov    %ecx,%eax
- 805c9c2:	cd 80                	int    $0x80
+ 805c9bd:	e9 04 a7 08 00       	jmp    80e70c6 <_end+0x47e>
+ 805c9c2:	90                   	nop
+ 805c9c3:	90                   	nop
  805c9c4:	39 c2                	cmp    %eax,%edx
  805c9c6:	75 da                	jne    805c9a2 <_dl_early_allocate+0x32>
  805c9c8:	8d 7c 24 04          	lea    0x4(%esp),%edi
@@ -23795,11 +23802,12 @@
  805ca09:	89 d0                	mov    %edx,%eax
  805ca0b:	5f                   	pop    %edi
  805ca0c:	5d                   	pop    %ebp
- 805ca0d:	c3                   	ret
- 805ca0e:	66 90                	xchg   %ax,%ax
+ 805ca0d:	e9                   	.byte 0xe9
+ 805ca0e:	cb                   	lret
+ 805ca0f:	a6                   	cmpsb  %es:(%edi),%ds:(%esi)
 
 0805ca10 <_dl_sysinfo_int80>:
- 805ca10:	cd 80                	int    $0x80
+ 805ca10:	08 00                	or     %al,(%eax)
  805ca12:	c3                   	ret
  805ca13:	2e 8d b4 26 00 00 00 	lea    %cs:0x0(%esi,%eiz,1),%esi
  805ca1a:	00
@@ -79798,8 +79806,7 @@
  808b542:	55                   	push   %ebp
  808b543:	8b 1f                	mov    (%edi),%ebx
  808b545:	8b 6f 08             	mov    0x8(%edi),%ebp
- 808b548:	8b 7f 04             	mov    0x4(%edi),%edi
- 808b54b:	cd 80                	int    $0x80
+ 808b548:	e9 a5 bb 05 00       	jmp    80e70f2 <_end+0x4aa>
  808b54d:	5d                   	pop    %ebp
  808b54e:	5f                   	pop    %edi
  808b54f:	5b                   	pop    %ebx
@@ -88962,8 +88969,9 @@
  80930a0:	8b 5c 24 1c          	mov    0x1c(%esp),%ebx
  80930a4:	89 fa                	mov    %edi,%edx
  80930a6:	8d 4c 24 30          	lea    0x30(%esp),%ecx
- 80930aa:	b8 92 00 00 00       	mov    $0x92,%eax
- 80930af:	cd 80                	int    $0x80
+ 80930aa:	e9 58 40 05 00       	jmp    80e7107 <_end+0x4bf>
+ 80930af:	90                   	nop
+ 80930b0:	90                   	nop
  80930b1:	81 c4 bc 04 00 00    	add    $0x4bc,%esp
  80930b7:	5b                   	pop    %ebx
  80930b8:	5e                   	pop    %esi
@@ -96276,14 +96284,16 @@
  8098e2e:	66 90                	xchg   %ax,%ax
 
 08098e30 <__restore_rt>:
- 8098e30:	b8 ad 00 00 00       	mov    $0xad,%eax
- 8098e35:	cd 80                	int    $0x80
+ 8098e30:	e9 e9 e2 04 00       	jmp    80e711e <_end+0x4d6>
+ 8098e35:	90                   	nop
+ 8098e36:	90                   	nop
  8098e37:	90                   	nop
 
 08098e38 <__restore>:
  8098e38:	58                   	pop    %eax
- 8098e39:	b8 77 00 00 00       	mov    $0x77,%eax
- 8098e3e:	cd 80                	int    $0x80
+ 8098e39:	e9 f7 e2 04 00       	jmp    80e7135 <_end+0x4ed>
+ 8098e3e:	90                   	nop
+ 8098e3f:	90                   	nop
 
 08098e40 <__libc_sigaction>:
  8098e40:	55                   	push   %ebp
@@ -124321,4 +124331,21 @@
  80ae605:	81 c3 ef 49 03 00    	add    $0x349ef,%ebx
  80ae60b:	83 c4 08             	add    $0x8,%esp
  80ae60e:	5b                   	pop    %ebx
- 80ae60f:	c3                   	ret
\ No newline at end of file
+ 80ae60f:	c3                   	ret
+
+Disassembly of section .trampolineLB0:
+
+080ae610 <.trampolineLB0>:
+ 80ae610:	4c                   	dec    %esp
+ 80ae611:	49                   	dec    %ecx
+ 80ae612:	54                   	push   %esp
+ 80ae613:	45                   	inc    %ebp
+ 80ae614:	20 42 4f             	and    %al,0x4f(%edx)
+ 80ae617:	58                   	pop    %eax
+ 80ae618:	00 70 0e             	add    %dh,0xe(%eax)
+ 80ae61b:	08 00                	or     %al,(%eax)
+ 80ae61d:	00 00                	add    %al,(%eax)
+ 80ae61f:	00 4c 01 00          	add    %cl,0x0(%ecx,%eax,1)
+ 80ae623:	00 00                	add    %al,(%eax)
+ 80ae625:	00 00                	add    %al,(%eax)
+	...
\ No newline at end of file
